{
  "openapi": "3.0.1",
  "info": {
    "title": "bidrag-sak",
    "version": "v1"
  },
  "paths": {
    "/sak/ny": {
      "post": {
        "tags": [
          "bidrag-sak-controller"
        ],
        "description": "Opprette ny sak",
        "operationId": "post",
        "parameters": [
          {
            "name": "X-Enhet",
            "in": "header",
            "description": "Saksbehandlers påloggede enhet",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "nySakCommandDto",
            "in": "query",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/NySakCommandDto"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Manglende eller utløpt id-token",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/NySakResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Saksbehandler mangler tilgang til å lese metadata for aktuell sak",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/NySakResponseDto"
                }
              }
            }
          },
          "201": {
            "description": "Sak opprettet",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/NySakResponseDto"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer-key": []
          }
        ]
      }
    },
    "/sak/{saksnummer}": {
      "get": {
        "tags": [
          "bidrag-sak-controller"
        ],
        "description": "Finn metadata for en bidragssak",
        "operationId": "findMetadataForSak",
        "parameters": [
          {
            "name": "saksnummer",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata for sak hentet. Hvis saksbehandler mangler tilgang til å lese metadata for aktuell sak så blir det sendt tom liste med roller i responsen",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/BidragSakDto"
                }
              }
            }
          },
          "404": {
            "description": "Sak ikke funnet"
          },
          "401": {
            "description": "Manglende eller utløpt id-token"
          }
        },
        "security": [
          {
            "bearer-key": []
          }
        ]
      }
    },
    "/pip/sak/{saksnummer}": {
      "get": {
        "tags": [
          "pip-controller"
        ],
        "description": "Finn metadata om for en bidragssak",
        "operationId": "get",
        "parameters": [
          {
            "name": "saksnummer",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/BidragSakPipDto"
                }
              }
            }
          }
        },
        "security": [
          {
            "basic-auth": []
          }
        ]
      }
    },
    "/person/sak/{fodselsnummer}": {
      "get": {
        "tags": [
          "bidrag-sak-controller"
        ],
        "description": "Finn metadata for bidragsaker tilknyttet gitt person",
        "operationId": "find",
        "parameters": [
          {
            "name": "fodselsnummer",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "404": {
            "description": "Ingen saker funnet for person i datasettet til Bisys"
          },
          "401": {
            "description": "Manglende eller utløpt id-token"
          },
          "200": {
            "description": "Metadata for sak hentet. Hvis saksbehandler mangler tilgang til å lese metadata for sak så blir kun fødslesnummer fra kallet inkludert i saken",
            "content": {
              "*/*": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/BidragSakDto"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer-key": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "NySakCommandDto": {
        "type": "object",
        "properties": {
          "eierfogd": {
            "type": "string",
            "description": "Sakens eierfogd (enhetsnummeret som får tilgang til saken"
          }
        },
        "description": "Data som trengs for å opprette et saksnummer for en bidragssak"
      },
      "NySakResponseDto": {
        "type": "object",
        "properties": {
          "saksnummer": {
            "type": "string",
            "description": "Saksnummer som ble tildelt "
          }
        },
        "description": "Response ved opprettelse av sak"
      },
      "BidragSakDto": {
        "required": [
          "erParagraf19",
          "roller"
        ],
        "type": "object",
        "properties": {
          "eierfogd": {
            "type": "string",
            "description": "Eierfogd for bidragssaken"
          },
          "saksnummer": {
            "type": "string",
            "description": "Saksnummeret til bidragssaken"
          },
          "saksstatus": {
            "type": "string",
            "description": "Saksstatus til bidragssaken"
          },
          "kategori": {
            "type": "string",
            "description": "Kategorikode: 'N' eller 'U'"
          },
          "erParagraf19": {
            "type": "boolean",
            "description": "Om saken omhandler paragraf 19"
          },
          "begrensetTilgang": {
            "type": "boolean",
            "description": "Om saken inneholder personer med diskresjonskode"
          },
          "roller": {
            "type": "array",
            "description": "Rollene som saken inneholder",
            "items": {
              "$ref": "#/components/schemas/RolleDto"
            }
          }
        },
        "description": "Metadata for en bidragssak"
      },
      "RolleDto": {
        "type": "object",
        "properties": {
          "foedselsnummer": {
            "type": "string",
            "description": "Fødselsnummer til en person i en bidragssak"
          },
          "rolleType": {
            "type": "string",
            "description": "Rolletypen til en person i en bidragssak, f.eks: BM eller BP (bidragsmottaker eller bidragspliktig)"
          }
        },
        "description": "Metadata for en rolle på en bidragssak"
      },
      "BidragSakPipDto": {
        "required": [
          "erParagraf19",
          "roller"
        ],
        "type": "object",
        "properties": {
          "saksnummer": {
            "type": "string",
            "description": "Saksnummeret til bidragssaken"
          },
          "erParagraf19": {
            "type": "boolean",
            "description": "Om saken omhandler paragraf 19"
          },
          "roller": {
            "type": "array",
            "description": "Fødselsnummer til personer innvolvert i bidragssaken",
            "items": {
              "type": "string",
              "description": "Fødselsnummer til personer innvolvert i bidragssaken"
            }
          }
        },
        "description": "Metadata for pip tjeneste (paragraf 19 på bidragssak, samt fnr for involverte roller"
      }
    },
    "securitySchemes": {
      "bearer-key": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  }
}
